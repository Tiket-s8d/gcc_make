# Для разворачивания CMake с нуля 
Для начала нужен файл CMakeLits.txt в котором прописаны все настройки проекта и находится он в одной директории с проектом, после чего нужно сделать директория **build**
зайти в нее и прописать 

```
cmake -G "генераторы"
```
Чтобы узнать какие генераторы есть на вашем устройстве, нужно прописать 
```
cmake --help
```


# Для сборки проекта типа Reales или Debug

Есть два способ как можно собирать проект.
### Способ 1
Для начала нужно перейти в директорию в которую будем собирать проект какого либо рода 
Например мы в директории project и она имеет такую структуру 
- project
	- main.c
	- CMakeLists.txt
	- Src/
	- Inc/
	- Debug/
	- Release/
Переходим в директорию Debug и прописываем 

```
cmake *Путь до CMakeList.txt*
cmake -DCMAKE_BUILD_TYPE=Debug *Путь до CMakeList.txt*
```
после чего программа собирется типа Debug.
Если возникла проблемма с генератором то нужно удалить все что создалось в директории Debug и прописать в ней следующию комманду
```

cmake -G *Название генератора*
```
после чего повторить предыдущую функцию.
Аналогично с Release
```
cmake *Путь до CMakeList.txt*
cmake -DCMAKE_BUILD_TYPE=Release *Путь до CMakeList.txt*
```

Так же можно прописать пути 
```
cmake -S . -B .
```
-S Путь до CmakeLists.txt
-B Путь где будет собираться весь проект

### Способ 2
Для начала все так же нужно перейти в в директорию и прописать
```
cmake *Путь до CMakeList.txt*
```
После чего нужно вернуться в CMakeLists.txt
и там прописать для Debug
```
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG${CMAKE_CURRENT_SOURCE_DIR}/Debug)
```
и для Release
```
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEAS ${CMAKE_CURRENT_SOURCE_DIR}/Release)
```
Так же можно прописать пути 
```
cmake -S . -B .
```
-S Путь до CmakeLists.txt
-B Путь где будет собираться весь проект

## Некоторые моменты для сборки проекта
Для того чтобы ускорить сборку проекта через  CMake можно прописать в терминале команду для сборки проекта в несколько потоков

```
cmake --build . --parallel 4
```
* parallel 4 - наш проект будет собираться с использование 4-х потоков 

Так же при сборке проекта можно очищать все объектные файлы которые было скомпилированы до этого 
```
cmake --build . --clean-first
```



# Команды общего назначения
```
cmake_minimum_required(VERSION)
```
VERSION должен состоять до 4 чисел. 
Команда определяет минимальную версию инструмента CMake, при помощи которого можно обрабатывать текущий входной файл проекта. Рекомендуется ставить эту функцию в самом начале файла.

---

```
project(*имя_проекта* [VERSION *версия*][LANGUAGES *язык1* ... *язык*])
```

VERSION и LANGUAGES являются не обязательными
VERSION должен состоять до 4 чисел. 
LANGUAGES после можно прописать языки с которыми сможет работать CMake, по умолчанию C и CPP подключены (Если не прописать какие языки используются в проекте то сам проект может не собраться, например: если не прописать ASM использования ассемблер файлов то его и нельзя будет подключить ) .
Функция project должны бать явна вызвана (не внутри модулей подключаемых при помощи include())

----
```
include(<модуль>|<файл> [OPTIONAL] [RESULT_VARIABLE <имя переменной>])
```


---
```
message([<режим>]<строка 1> ... <строка n>)
```
<режим> := STATU | WARNING | AUTHOR_WARNING | SEND_ERROR | FATAL_ERROR | DEPRECATION

| Режим | Описание | Обработка | Генерация |
|-------|----------|-----------|-----------|
| STATUS | Важная информация | +| + |
| WARNING | Обычная информация |+ | + |
|AUTHOR_WARNING  | Предупреждения для разработчика | + | + |
| SEND_ERROR | Локальная ошибка | + | - |
| FATAL_ERROR | Серьёзная ошибка | - | - |
| DEPRECATION | Исаользование устаревшей возможности| Настриваемая | Настриваемая |

#  Подключение фалов из других директорий
Например мы находимся в директории
- main.c
- Inc/
	- main.h
	- test.h
- Src/
	- test.c
 CMakeLists.txt
Все необходимые файлы для сборки в объектные файлы можно подключить двумя способами.
## 1 SET
В функцию сет можно передать несколько путей до разных фалов
```
set(*Название для переменной* *Путь* PATH/src/buf.c)
```
## 2 file
В команду файл можно передать директорию в которой находятся необходимые файл
```
file(GLOB *Название переменной* *Путь до файлов*)
```
Пример:
```
file(GLOB VAR_SRC PATH/src/*.c) # Взять все файлы .c из директории
```

это нужно чтобы потом добавить слинковать объектные файлы с main файлом



Для подключения заголовочных файлов к main.c нужно в файле CMakeLists.txt прописать
```
include_directories(*путь до Inc*)
```

И в команде add_executable дописать
```
add_executable(MyApp main.c *переменная в которой прописаннеы пути до необходимых файлов*)
```




## Для сборки всех файлов в объектный 
add_executable(${TARGET_NAME} ${INCLUDE} ${SOURCE} ${INCLUDE_2} ${SOURCE_2} . . .)




# Подключение нескольких CMake файлов 
В директории необходимо создать файл CMakeLists.txt от которого и будут идти все наследования. В этом файле прописывается и версия CMake и путь до toolchain.cmake. 
После чего в любой из директории которая находятся ниже чем основной CMakeLists файл 
можно создать CMakeLists файл который будет наследовать все из основного CMake файла 
- CMakeLists.txt
- /dir
	- main.c 
	- main.h
	- CMakeLists.txt
- /Lib
	- lib.c
	- lib.h
	- CMakeLists.txt
В 1-ом файле CMakeLists нужно прописать 
```
cmake_minimum_required(VERSION 3.26)
    set(CMAKE_TOOLCHAIN_FILE ./toolchain.cmake)
        project(*ProjectName* C ASM)
add_subdirectory(dir)
add_subdirectory(Lib)
```
в CMakeLists файлах в директориях dir и Lib уже не нужно прописывать версию название проекта и toolchain файл так как все сборка будет происходить из 1-го CMakeLists  файла.

# Создание переменной для настройки окружения 
В cmake есть стандартные переменные в которые можно передать значения посредством 
```
set(...)
```
В самом CMakeLists.txt файле или при вызове cmake через терминал 
```
cmake *путь до CMakeLists.txt* -D*Название Переменной*=*значение*
```
Но так же можно создать свою переменную в которую можно передавать значения через терминал. Что бы сделать такую переменную нужно в CMakeLists.txt прописать:
```
set(*Название переменной* "*значение по умолчанию*" CACHE *тип переменной* "*Описание переменной*")
```
Пример:
```
set(PROJECT_NAME "option_value" CACHE STRING "Some user-specified option")
```
* Переменная **PROJECT_NAME**
* Значения по умолчанию: **option_value**
* Тип переменной: **String**
* Описание переменной: **Some user-specified option**

Что бы изменить значение этой переменной нужно прописать в терминале 
```
cmake *путь до CMakeLists.txt* -D*Название Переменной*:STRING=*значение*
```


# toolchain
В файле toolchain прописывается вся настройка проекта, какой компилятор использовать, какой стандарт языка, флаги для компилятор и компоновщик 

## Для Debug версии
Можно прописать через if else флаги оптимизации и всякого такого [link](https://stackoverflow.com/questions/48754619/what-are-cmake-build-type-debug-release-relwithdebinfo-and-minsizerel)|



